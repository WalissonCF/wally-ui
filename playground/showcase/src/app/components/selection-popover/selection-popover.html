<div class="relative">
  <!-- Original content (where user will select text) -->
  <ng-content></ng-content>

  <!-- Floating popover -->
  @if (isVisible()) {
  <div #popover
    class="fixed z-50 bg-white dark:bg-neutral-900 shadow-lg rounded-xl border border-neutral-300 dark:border-neutral-700 transition-opacity duration-150"
    [class.p-1]="!isMobile()"
    [class.p-2]="isMobile()"
    [class.opacity-0]="!isPositioned()"
    [class.opacity-100]="isPositioned()"
    [style.top.px]="adjustedPosition().top" [style.left.px]="adjustedPosition().left" role="dialog"
    aria-label="Selection actions"
    (click)="onPopoverClick()">

    <!-- Customizable content via content projection (always rendered) -->
    <div #customActionsSlot [class.hidden]="!hasCustomActionsSignal()">
      <ng-content select="[popoverActions]"></ng-content>
    </div>

    <!-- Fallback: default button (hidden if custom actions exist) -->
    <button [class.hidden]="hasCustomActionsSignal()"
      class="text-[#0a0a0a] text-sm font-mono hover:bg-neutral-100 dark:text-white dark:hover:bg-neutral-800 rounded transition-colors cursor-pointer"
      [class.px-3]="!isMobile()"
      [class.py-2]="!isMobile()"
      [class.px-4]="isMobile()"
      [class.py-3]="isMobile()">
      Default Action
    </button>
  </div>
  }
</div>